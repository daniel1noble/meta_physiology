---
title: "Meta-analytic approaches and effect sizes to account for 'nuisance heterogeneity' in comparative physiology"
bibliography: ../bib/refs.bib
csl: ../bib/the-journal-of-experimental-biology.csl
output: 
  bookdown::word_document2:
    toc: no
    toc_depth: 6
    number_sections: false
    reference_docx: template.docx
  bookdown::html_document2:
    code_folding: hide
    number_sections: no
    toc: no
    toc_depth: 6
    toc_float: yes
    bibliography: refs.bib
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
  knitr::opts_chunk$set(echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, tidy = TRUE, fig.width = 10)
  ## numbers >= 10^5 will be denoted in scientific notation,		  ## numbers >= 10^5 will be denoted in scientific notation,
    ## and rounded to 2 digits		  ## and rounded to 2 digits
    options(digits = 2)
    
    # If you have issues with flextable and equatags, make sure you have node.js and use mathjax_install(). See here:https://github.com/ardata-fr/equatags
  pacman::p_load(flextable, tidyverse, equatags, png, magick, RColorBrewer)  
```

Daniel W.A. Noble$^{1,*}$, Patrice Pottier$^{2}$, Malgorzata Lagisz$^{2}$, Samantha Burke$^{2}$, Szymon M. Drobniak$^{2}$, Rose E.  O'Dea$^{2}$, Shinichi Nakagawa$^{2}$

$^{1}$ Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra, ACT 2600, Australia

$^{2}$ Ecology & Evolution Research Centre, School of Biological, Earth and Environmental Sciences, University of New South Wales, Sydney, NSW 2052, Australia

## **Abstract**

Meta-analysis is a powerful tool to generate quantitatively informed answers to pressing global challenges. By distilling data from broad sets of research designs and study systems into standardized effect sizes, meta-analyses provide physiologists with opportunities to estimate overall effect sizes and understand the drivers of effect variability. Despite this ambition, research designs in the field of comparative physiology can appear, at the outset, as being vastly different to each other because of 'nuisance heterogeneity' (e.g., different temperatures or treatment dosages used across studies). Methodological differences across studies have led many to believe that meta-analysis is an exercise in comparing "apples with oranges". Here, we dispel this myth by showing how standardised effects sizes can be used in conjunction with multilevel meta-regression models to both account for the factors driving differences across studies and make them more comparable. We assess the prevelance of nuisance hetrogeneity in the comparative physiology literature -- showing it is common and often not accounted for in analyses. We then formalise effect size measures (e.g., the temperature coefficient, $Q_{10}$) that provide comparative physiologists with a means to remove nuisance heterogeneity without the need to resort to more complex statistical models that may be harder to interpret. We also describe more general approaches that can be applied to a variety of different contexts to derive new effects sizes and sampling variances, opening up new possibilities for quantitative synthesis. By using effect sizes that account for components of effect heterogeneity, in combination with existing meta-analytic models, comparative physiologists can explore exciting new questions while making results from large-scale data sets more accessible, comparable and widely interpretable.

## **Introduction**

Meta-analysis has emerged as the 'gold-standard' across various disciplines for quantitative synthesis and is becoming increasingly prominent in the field of comparative physiology  [@Gurevitch2018; @Nakagawa2017; @Glass2015]. Meta-analyses answer research questions by synthesising research results and identifying sources of variation across studies [@Nakagawa2017; @Gurevitch1999; @Gurevitch2018; @Cooper2009; @Arnqvist1995; @Koricheva2013; @Borenstein2019]. Ideally, meta-analyses are part of a systematic review. As such, methods are carefully reported upon to ensure the review and data collation are transparent and reproducible [i.e., see the Preferred Reporting Items for Systematic Reviews and Meta-Analyses in Ecology and Evolutionary Biology (PRISMA-EcoEvo) checklist, @ODea2021]. 

A meta-analysis can have three goals: 1) to provide an overall mean estimate of a treatment effect or relationship, 2) to quantify effect size variance and understand key drivers explaining differences in effects across studies and 3) attempt to identify research gaps and publication biases [@Nakagawa2017; @Gurevitch1999; @Gurevitch2018; @Cooper2009; @Koricheva2013; @Borenstein2019]. Meta-analysing independent studies provides greater statistical power and precision than what any individual study on its own would be able to provide -- particularly given that most empirical studies are already under-powered in many areas of biology [@Forstmeier2017; @Jennions2003; @Button2013]. By expressing study effects on a common scale (i.e., standardised effect size) we can gain broader insight into the direction and efficacy of a particular treatment effect or the strength of a relationship between two variables of interest [@Gurevitch2018; @Koricheva2013]. Meta-analyses have already provided comparative physiologists with powerful insights on pressing global challenges -- from testing whether physiological plasticity can buffer organisms against climate change [e.g, @Seebacher2015] to the degree to which endocrine disrupting chemicals, such as bisphenol A (BPA), impact aquatic organisms [e.g., @WuSeebacher2020].

Despite its widespread adoption and well-established methodological procedures, meta-analysis is often criticised for mixing 'apples and oranges' -- in other words, mixing effects from studies that are not comparable [@Gurevitch2018; @Arnqvist1995; @Gallo1979; @Carpenter2020; @Stewart2010; @Glass2015]. Lack of comparability could result from studies differing in experimental design, species, measurement variables and sampling units [@Arnqvist1995; @Stewart2010]. For example, experimental designs in the field of comparative physiology can vary greatly in the temperatures or dosages of chemicals that they use in experimental treatments [e.g., @WuSeebacher2020]. To the uninitiated, this concern might not be unfounded given that heterogeneity in effects is often high in ecological and evolutionary meta-analyses [@Senior2016], telling us that the effect size varies a great deal across studies. However, to many, having highly heterogeneous effects "...is the spice of life" [p.g., 519; @Cooperetal2019] because it provides opportunities to explore the reasons for why effects vary within and across studies [@Cooperetal2019; @Borenstein2019; @Gurevitch2018; @Glass2015].

The goal of our review is to briefly overview the meta-analytic process and argue for the value of heterogeneity in answering fundamental research problems and guiding research directions. We present results from a survey of published meta-analyses in the field of comparative physiology to gauge methodological and meta-analytic practices -- determining what types of effect sizes are commonly used, how often effect size estimates are impacted by nuisance heterogeneity and whether meta-analytic models (i.e., models that account for sampling variance) are commonly applied. Then, we show how 'nuisance heterogeneity' in comparative physiology can be comfortably dealt with by re-formalising many existing effect size measures and / or by using multilevel meta-regression models. We formalise alternative effect sizes and their associated sampling variance to provide comparative physiologists with opportunities to explicitly incorporate nuisance heterogeneity at the effect size level to ease their interpretation. Finally, we describe how more complex treatment differences, such as non-linear dosage differences, can be accommodated using multilevel meta-regression models. We hope that expanding the meta-analytic toolkit will provide new opportunities for comparative physiologists to address how organisms will cope with rapidly changing environments and anthropogenic stressors in the future.

## **The Apples and Oranges 'Problem' in Comparative Physiology**

Meta-analysis is always concerned with effect heterogeneity; in other words, the factors that drive differences in the direction and magnitude of effects within and across studies [@Nakagawa2017; @Gurevitch2018; @Cooperetal2019; @Borenstein2019; @Lag2010]. The concept of heterogeneity is vitally important because it tells us how general our findings are likely to be and how much of the variance we see is the result of real biology or methodological differences (after accounting for sampling variance) [@Nakagawa2017; @Borenstein2019; @Lag2010].

There are many phenomena driving effect heterogeneity. First, there is inherent uncertainty in estimating the ‘true’ population effect (e.g., a correlation coefficient) from smaller samples [@Borenstein2019]. A formal meta-analysis weights sample estimates by their precision, and removes this source of heterogeneity [@Gurevitch2018; @Koricheva2013]. Removing sampling variance is possible because we know, mathematically, how to calculate it for many effect measures. While unweighted analyses are common, weighting studies makes overall estimates more precise, and less susceptible to publication bias (see below), even if the overall mean itself is unbiased [@Morrissey2016a]. Second, there are sociological factors impacting heterogeneity. These include the ease with which novel and significant results are published relative to non-significant results, manifesting as publication bias [@Jennions2013; @Nakagawa2021b; @Rothstein2005]. Third, real biological processes can drive effect heterogeneity. This is particularly true in comparative physiology where we synthesise data from different species with varying life-histories, habitats, mating systems and reproductive modes. As comparative physiologists, this is the stuff that gets us up every morning! We can model these biological factors by including relevant predictors (moderator variables) and/or random effects (to account for non-independence of effects). By doing so, we can test predictions from hypotheses about the key players impacting mean effect size and direction. This improves our understanding of the biological world around us and helps inform on future research directions. 

Finally, methodological factors are also big contributors to effect variability. In some cases, these methodological factors are of direct interest. For example, the methods for measuring an outcome variable can result in different effects, and it is important we know and understand this to determine how experiments can be designed in the future. In other cases, methodological factors might be considered 'nuisance heterogeneity' [following from @Cooperetal2019] -- factors we know vary, but are rather unsurprising to us (Figure \@ref(fig:fig1)). These might include differences in temperature, pH, dosages, water potential etc. Regardless of the relative importance of such variables compared to core questions in a meta-analysis, nuisance variables may complicate the interpretation of effect sizes used if not accounted for properly.

```{r, fig1, fig.cap="**Sources of effect size heterogeneity in meta-analyses**. Heterogeneity can come in various forms, from effect measures varying as a result of shared evolutionary history (i.e., phylogeny), the different trait types measured, and sources of 'nuisance heterogeneity'. In this example, nuisance heterogeneity is generated by differences in the experimental temperatures at which the animals were tested ('gray' shaded area on top). However, nuisance heterogeneity can come in various other forms such as differences in dosage. We can control for these types of heterogeniety by reformalising effect sizes and/or using multilevel metaregression ('white' area on the bottom)."}
image <- image_read(here::here("figs", "Fig1_v2_ML.png"))
image
```

Besides sampling variance, all the sources of heterogeneity discussed above contribute (to varying extents) to the 'apples and oranges' problem often touted as compromising the reliability of meta-analyses. Combining standardised effects, while ignoring these sources of heterogeneity can indeed weaken the reliability of a meta-analysis. However, many argue that heterogeneity is just what we are interested in synthesizing [@Cooperetal2019; @Borenstein2019; @Gurevitch2018; @Glass2015; @Lag2010]. In the words of Gene Glass, the founder of meta-analysis: "Of course it [meta-analysis] mixes apples and oranges; in the study of fruit nothing else is sensible; comparing apples and oranges is the only endeavor worthy of true scientists; comparing apples to apples is trivial" [p.g., 224, @Glass2015]. Whether comparing apples and oranges is a good idea simply boils down to the specific question of interest, the population one wishes to make conclusions about and how heterogeneous effects actually are. If we are interested in generalising only to apples, then mixing fruit will not be ideal. However, if we want to understand why different 'fruit' vary in their properties, then we need to consider apples and oranges together [@Borenstein2019].

We tend to agree with @Glass2015, and his sentiment is particularly relevant to comparative physiology. For example, if we want to understand the impact of a pollutant on reproduction in aquatic organisms, including aquatic mammals and fish would provide answers to this general question, even if their reproductive biology and physiology are different. Synthesizing diverse study outcomes allows us to also understand critical features of the literature, study systems (e.g., different effects of pollutants on fish and mammal reproduction), and approaches (e.g., short-term vs long-term studies) that can explain the diversity of effect outcomes observed. Doing so provides a rich set of conclusions that can draw attention to important sources of variability that might have otherwise been overlooked. Having said that, it is still very important to understand the limitations and diversity of studies included in a meta-analysis, and how this can affect interpretations made -- an important reason why transparency and reproducibility are such a prominent feature of meta-analysis (or ideally should be) [@ODea2021]. The validity of general conclusions to certain questions (e.g., what is the overall effect of a pollutant on reproduction?) will inevitably depend on the homogeneity of effects being synthesized. If the estimate of an overall effect coincides with low heterogeneity then the effects are reasonably consistent [@Borenstein2019]. If, however, an overall effect is accompanied by large heterogeneity, then we would shift focus and explore drivers of that heterogeneity. For example, given the very different physiology of aquatic mammals and fish, understanding an overall combined effect on reproduction may not be particularly relevant and may even be misleading. It may, therefore, be more useful to understand overall effects in each of these groups separately, and assess the extent to which they differ. 

## **Nuisance Heterogeneity Complicates Meta-analytic Interpretations**

Nuisance heterogeneity can get in the way of understanding real biological patterns that interest comparative physiologists. Take for example a meta-analysis that attempts to assess the effects of diet on fish growth across different populations of a widely distributed (cosmopolitan) species. Studies might rear populations of the same fish species under different temperatures, but in the end, they are still all governed by the same thermodynamic effects on growth. In this situation, we are still interested in understanding overall diet effects, but we may question whether such a conclusion is sensible given the diversity of temperatures applied. If temperature differences are of direct interest, then this variable can be formally incorporated in statistical models. If, however, it is not the primary interest, then it may introduce an unnecessary complication to the interpretation of the effect of diet on fish growth. Such heterogeneity is an important  contributing factor to the ‘apples and oranges’ problems described above. Nonetheless, there is limited discussion about the ways in which it can be dealt with in the literature.

Here, we focus on meta-analytic solutions to circumvent nuisance heterogeneity showing how it can easily be overcome using a number of meta-analytic tools. Prior to overviewing the solutions, we conducted a literature survey to better understand the different types of effect sizes being used in comparative physiology, the susceptibility of studies to nuisance heterogeneity, and how these sources are currently (if at all) being controlled for in a meta-analysis. More specifically we asked: 1) what type of effect size was used within the quantitative synthesis? 2) based on the methods provided, was the effect size likely susceptible to nuisance heterogeneity? 3) If so, was such variation accounted for in the effect size or during analysis? and finally, 4) how many analyses used ‘weighted’ meta-analytic models? 

We searched the Scopus database between May 16 and 18, 2021, with a follow up search on September 1, 2021 (see the Supplementary Information). After a series of pilot searches (detailed in Supplementary Materials) to refine our search string [See @Foo2021 for an overview of this process], we searched for studies that included: 'meta-analysis', 'meta regression', 'comparative analysis', 'comprehensive analysis' 'global analysis' or 'macro physiology' in their title or abstract. We restricted our search to key comparative physiology journals known to the authors that would likely contain literature-based quantitative syntheses within the last 6 years (detailed in Table S1 and S2 - Supplementary Materials). We expected this to provide a contemporary overview of quantitative syntheses in comparative physiology while making the survey and screening feasible. We acknowledge that this may have missed some important, and influential, quantitative syntheses in the field of comparative physiology, but likely provided an informative random sample.

All title, abstract and full text screening was done by two people (DWAN and ML). Any disagreements were resolved by discussion to reach a consensus. Out of the 426 papers originally identified, 80 full texts were screened for eligibility, and we included a total of 63 for final data extraction. For full details on the search strings used, search dates, the number of papers found, and our PRISMA flowchart (along with reasons for exclusion at the full text stage) we refer readers to the Supplementary Information. 

To address our questions, we categorised effect sizes as falling into the following categories: Response Ratio (*lnRR*), Standardised Mean Differences (*SMD*; e.g., Hedges *d*, *g* or Cohen's *d*), Correlation or Fisher's Z -transformed correlation (*Zr*), Regression Slopes (Slopes), Risk Ratios, or whether the paper analysed the raw data or summary statistics directly (i.e., means/proportions) (which we labelled as 'raw'). All other effects were labelled as 'other'. To determine whether effect sizes were likely to vary based on some underlying continuous variable or were dependent on the context in which traits were measured, we assessed whether authors: 1) acknowledged this explicitly in the paper or 2) accounted for it in their models. If it was not clear, two of us (DWAN & PP) discussed the paper, and made a decision about whether the effect measure was likely to be impacted. For example, trait means, such as ectothermic metabolic rate (i.e., raw/mean/proportion-based effect size), will vary depending on the temperature being measured. The magnitude of differences between two treatments (e.g, contrast-based effect sizes -- *SMD* or *lnRR*) will depend on the pH or dosage used in treatments, and the strength of relationship between two variables (e.g., correlation between behaviour and metabolism) might depend on the temperature context under which metabolic rate or behaviour were measured. Given the high heterogeneity in effects used in comparative physiology, we expected nuisance heterogeneity to be common to most effect sizes. 

We also categorised the types of statistical models fit in each study as: 1) fixed-effect meta-analysis; 2) random-effects meta-analysis (i.e., intercept-only model, but has random study effects); 3) multilevel meta-analysis (i.e., intercept-only model, but has multiple random effect levels such as study, species and observation-level random effects); 4) meta-regression models (i.e., a multilevel or random-effects model with fixed effects - including random effects); 5) weighted regression models (including mixed- effects models); and 6) linear regression models (including linear and generalised linear mixed-effect models, and phylogenetic least squares models) [see @NakagawaSantos2012 for discussion of models]. Notably, only model types 1--5 are weighted models because they weight effect sizes based on the inverse of their sampling variance or sample size. 

We summarise the results of our literature survey below while discussing solutions for dealing with nuisance heterogeneity. 

```{r setup2, include=FALSE}
rm(list=ls())

pacman::p_load(dplyr,ggplot2,here, pander, janitor, patchwork, forcats)

# loading data
raw <- read.csv(here("data","MA_CompPysio_Survey.csv"))
metadata <- read.csv(here("data","MA_CompPysio_Survey_metadata.csv"))

# tidying data
dat <- raw
names(dat) <- metadata$Procesed.Column.Name[match(names(dat), metadata$Raw.Column.Name)]

# tidying categorical options
dat$meta_analysis_self_described <- factor(gsub(" \\(.*", "", dat$meta_analysis_self_described), levels = c("yes","no","unclear/other"))
dat$comparative_physiology_main_focus <- factor(gsub(" \\(.*", "", dat$comparative_physiology_main_focus), levels = c("yes","no","unclear/other"))

# fixing format of journals

#dat$DOI[dat$journal=="2017"] # Typo
dat$journal[dat$journal=="2017"] <- "Biology Letters"

#dat$DOI[grep("Proceedings", dat$journal)] # all the same journal
dat$journal[grep("Proceedings", dat$journal)] <- "Proceedings of the Royal Society B: Biological Sciences"

# standardising DOI format
dat$DOI <- gsub(".*org/", "", dat$DOI)
dat$DOI <-gsub(".* ", "", dat$DOI)

# ggplot2 theme for plots
background.colour <- "white"
text.colour <- "black"
# Font Choice
#loadfonts()
text.font <- "Arial"

tm <- theme(panel.background = element_rect(fill = background.colour),
            plot.background = element_rect(fill = background.colour),
            panel.grid = element_blank(),
            text =  element_text(family = text.font, colour = text.colour),
            axis.text = element_text(colour = text.colour),
            axis.title.x = element_text(margin = margin(10,0,0,0)),
            axis.title.y = element_text(margin = margin(0,10,0,0)),
            axis.line = element_line(colour = text.colour, size = 0.5),
            axis.ticks = element_line(colour = text.colour, size = 0.5),
            plot.title = element_text(hjust = 0.5),
            legend.background = element_rect(fill = background.colour),
            legend.key = element_rect(fill = background.colour),
            plot.margin = margin(6,6,6,6)) 

effects <- dat %>% dplyr::group_by(effect_size_type) %>% janitor::tabyl(effect_size_type) %>%
  dplyr::summarise(SMD = dplyr::if_else(grepl("SMD", effect_size_type), n, 0),
                  lnRR = dplyr::if_else(grepl("Response Ratio", effect_size_type), n, 0),
                    Zr = dplyr::if_else(grepl("correlation", effect_size_type), n, 0),
                 Other = dplyr::if_else(grepl("other|Q10", effect_size_type), n, 0),
                 Means = dplyr::if_else(grepl("mean/proportion/raw", effect_size_type), n, 0),
                 lnCVR = dplyr::if_else(grepl("lnCVR", effect_size_type), n, 0),
                 Slope = dplyr::if_else(grepl("slope", effect_size_type), n, 0)) %>% 
  colSums(.) %>% data.frame(effect = names(.), n = .) %>% mutate(prop = n / sum(n)) %>% arrange(prop)

hetero <- dat %>%  janitor::tabyl(cont_moderator_variable)
hetero_dealt <- dat %>%  filter(!cont_moderator_variable_modelled=="") %>% janitor::tabyl(cont_moderator_variable_modelled)
weighted <- dat %>% janitor::tabyl(meta_analysis_weighted) 
weighted_meta <- dat %>% filter(meta_analysis_self_described == "yes") %>% janitor::tabyl(meta_analysis_weighted) 

summary <-  dat %>% dplyr::group_by(stat_model_type) %>% janitor::tabyl(stat_model_type) %>%
  dplyr::summarise(`Multilevel Meta-analysis Model` = dplyr::if_else(grepl("multilevel meta-analysis", stat_model_type), n, 0),
                  `Multilevel Metaregression Model` = dplyr::if_else(grepl("meta-regression models", stat_model_type), n, 0),
                    `Linear Regression` = dplyr::if_else(grepl("linear regression", stat_model_type), n, 0),
                 Other = dplyr::if_else(grepl("unclear/other", stat_model_type), n, 0),
                 `Vote Counting` = dplyr::if_else(grepl("vote counting", stat_model_type), n, 0),
                 `Weighted Regression` = dplyr::if_else(grepl("weighted regression including mixed effects models", stat_model_type), n, 0),
                 `Random Effects Model` = dplyr::if_else(grepl("random-effects meta-analysis", stat_model_type), n, 0)) %>% 
  colSums(.) %>% data.frame(effect = names(.), n = .) %>% mutate(prop = (n / sum(n))) %>% arrange(effect)
rownames(summary) <- NULL

het_reported <- dat %>%  filter(!heterogeneity_reported=="N/A (e.g. they conducted unweighted meta-analysis)") %>% mutate(heterogeneity_reported = if_else(heterogeneity_reported == "unclear/other (add comment)", "other", heterogeneity_reported)) %>% janitor::tabyl(heterogeneity_reported)
```


## **Opening New Opportunities in Comparative Physiology: Expanding the Breadth of Effect Sizes to Deal with Nuisance Heterogeneity**

#### *Common Effect Sizes and Sampling Errors that are Useful in Comparative Physiology*

The key features of all effect sizes used in meta-analyses are that: 1) they are statistical parameters that have been placed on a common scale so that they can be compared across studies and 2) they have some associated measure of precision (i.e., sampling variance) [@Koricheva2013; @Borenstein2009; @Schmid2021]. Effect sizes in comparative physiology are quite diverse; they can be the mean difference between two groups [e.g., difference in mean between a control and treatment group; e.g., @WuSeebacher2020], the slope of a regression [e.g., between body size and metabolic rate, @Uyeda2017], a correlation between two variables [e.g., between hormone levels and behaviour, @Holtman2016], or even the raw mean (or variance) itself [e.g., comparing CTmax or CTmin across species - e.g., @Sunday2014]. 

In many cases, different effect sizes might be used depending on the question. For example, to investigate the effect of temperature on a physiological trait, one can compile studies experimentally manipulating temperature and analyse the mean 'effect' by creating contrast-based effect sizes, or alternatively, just model the trait in each temperature treatment. The choice as to which one to use boils down to the types of data available from primary studies, the specific question of interest, and whether studies are observational or experimental in nature. Considering our temperature example above, if we are interested in the magnitude of change between temperature treatments, we may want to use a contrast-based effect size, such as the log response ratio, *$\ln{RR}$*. Instead, if we are interested in how the mean of some physiological trait changes with temperature, we may model the mean itself. In the latter scenario, as long as all the means are measured in the same units (e.g., degrees Celsius) or can be converted to the same units, then the mean may provide the desired answer to the original question. 

The results of our literature survey show that quantitative syntheses in comparative physiology commonly analyse raw summary statistics (`r with(effects, effects[effect == "Means","prop"])*100`% of studies), followed closely by Fishers transformed correlation coefficients (*Zr*) (`r with(effects, effects[effect == "Zr","prop"])*100`% of studies), standardised mean differences (*SMD*) (`r with(effects, effects[effect == "SMD","prop"])*100`%  of studies), and log response ratios (*lnRR*) (`r with(effects, effects[effect == "lnRR","prop"])*100`%, of studies) (Figure \@ref(fig:figsurv)A). We provide details on different effect measures and associated sample sizes in Table \@ref(tab:tablea). In many cases, studies make use of multiple effect size measures. Approximately `r with(hetero, hetero[cont_moderator_variable == "yes","percent"])*100`% of effect sizes used within the study were deemed to be impacted by nuisance heterogeneity in some form or another (Figure \@ref(fig:figsurv)B), but of the studies where this was the case, only `r with(hetero_dealt, hetero_dealt[cont_moderator_variable_modelled == "yes","percent"])*100`% of the studies clearly dealt with it (Figure \@ref(fig:figsurv)B), often through meta-regression modelling.

```{r, figsurv, fig.wid = 16.833333, fig.height=5,fig.cap="**Summary of meta-analytic practices in comparative physiology.** (A) Different types of effect measures commonly used in meta-analyses and their relative frequency of use. (B) Frequency of studies where nuisance heterogenity had the potential to impact effect sizes (x-axis), and the frequencies of studies explicitly dealing with nuisance heterogeneity (bar colour). (C) Frequencies of analytical approaches used to analyse effect measures. 'Orange' bars indicate weighted models."}
p1 = dat %>% dplyr::group_by(effect_size_type) %>% janitor::tabyl(effect_size_type)  %>% 
  dplyr::summarise(SMD = dplyr::if_else(grepl("SMD", effect_size_type), n, 0),
                  lnRR = dplyr::if_else(grepl("Response Ratio", effect_size_type), n, 0),
                    Zr = dplyr::if_else(grepl("correlation", effect_size_type), n, 0),
                 Other = dplyr::if_else(grepl("other|Q10", effect_size_type), n, 0),
                 Mean = dplyr::if_else(grepl("mean/proportion/raw", effect_size_type), n, 0),
                 lnCVR = dplyr::if_else(grepl("lnCVR", effect_size_type), n, 0),
                 Slope = dplyr::if_else(grepl("slope", effect_size_type), n, 0)) %>% 
  colSums(.) %>% data.frame(effect = names(.), n = .) %>% mutate(prop = n / sum(n)) %>% arrange(effect) %>% 
  mutate(effect = fct_relevel(effect, c("Other", "Zr", "lnRR", "SMD", "lnCVR", "Slope", "Mean"))) %>% 
  ggplot() + tm + 
  geom_col(aes(x = effect, y = prop), width = 0.5, fill = "black", colour = text.colour, size = 0.5) +
  scale_y_continuous(expand=c(0,0), limits = c(0,0.35)) +
  labs(x = "Effect Size",
       y = "Frequency") +
  coord_flip()

p2 = dat %>% mutate(cont_moderator_variable_modelled = if_else(cont_moderator_variable_modelled == "", "N/A", cont_moderator_variable_modelled)) %>% 
  ggplot() + tm +
  geom_bar(aes(x = cont_moderator_variable,
               fill = cont_moderator_variable_modelled,
               y = ..count../sum(..count..)), width = 0.5,
           colour = text.colour, size = 0.5) +
  scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
  scale_fill_viridis_d() +
  theme(legend.position = c(0.45, 0.8),
        legend.background=element_blank()) + 
  labs(x = "Nuisance Heterogeneity?",
       y = "Frequency",
       fill = "Modeled Nuisance\nHeterogeneity?") 

p3 <- summary %>% 
  mutate(effect = fct_relevel(effect, c("Other","Vote Counting", "Linear Regression", "Weighted Regression", "Random Effects Model", "Multilevel Meta-analysis Model", "Multilevel Metaregression Model")),
              col = c("#66C2A5", "#8DA0CB", "#8DA0CB", "#66C2A5", "#8DA0CB", "#66C2A5", "#8DA0CB")) %>% 
  ggplot() + tm +
  geom_col(aes(x = effect, y = prop, fill = col), width = 0.5,colour = text.colour, size = 0.5) +
  scale_y_continuous(expand=c(0,0),limits = c(0,0.4)) +
  scale_fill_brewer(palette = "Set2") + 
  labs(x = "Analytical Approach",
       y = "Frequency") +
  theme(legend.position = "none") +
  coord_flip()

p1 + p2 + p3 + plot_annotation(tag_levels = c("A"), tag_prefix = "(", tag_suffix = ")")

```

```{r tablea, echo = FALSE, tab.cap = "**Common effect sizes used throughout meta-analyses in comparative physiology, their associated sampling variances and examples on when they might be used**. M: mean; SD: standard deviation; N: sample size; CTmin: critical thermal minimum; CTmax: critical thermal maximum; LC_50: median lethal concentration; LT_50: median lethal temperature; BPA: bisphenol A."}

FitFlextableToPage <- function(ft, pgwidth = 6){

  ft_out <- ft %>% autofit()

  ft_out <- width(ft_out, width = dim(ft_out)$widths*pgwidth /(flextable_dim(ft_out)$widths))
  return(ft_out)
} 

# I'm just listing a bunch here, but we should think about what we want to include. Here's an example of how we can make a table with all equations. Fun! Really useful website here: https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference. Something wrong with character coding when rendering word document. Has to do with the log odds ratio equation. Renders fine in html, but just stops when word
names <- c("Mean",
           "Log Standard deviation, lnSD",
           "Log Response Ratio, lnRR",
           # leave this for now??? - we introduce this later
           "Standardised Mean Difference, SMD",
           "Zr (Fisher Transformation of \n Correlation Coefficient, r)")
           #"Log Odds Ratio",
           #"")

# the index i is not really applied consistently so I am adding it more (to do)
# we shoudl discuss what kinds of notations we want to use consistely
           
eqns_yi <- c("M",
             "\\ln{SD} + \\frac{1}{2(N - 1)}",
             # Senior will have a better version but this is good for now
             "\\ln \\left( \\frac{M_{1}}{M_{2}}\\right)",
             "\\frac{\\left( M_{2} - M_{1}\\right)}{SD_{p}}J",
             # we need to spell out SD_p somewhere
             "\\frac{1}{2}log \\left( \\frac{1+r}{1-r}\\right)")
             #"log\\left(\\frac{y_{i2}+0.5}{n_{i2}-y_{i2}+0.5}\\right) ",
             #"- log\\left(\\frac{y_{i1}+0.5}{n_{i1}-y_{i1}+0.5}\\right)")
             
# Just placeholders for now
eqns_vi <- c("\\frac{SD^2}{N}",
             "\\frac{1}{2(N - 1)}",
             "\\frac{SD_{1}^2} {M^2_{1}N_{1}} + \\frac{SD_{2}^2} {M^2_{2}N_{2}}",
             "\\frac{N_{1} + N_{2}}{N_{1}N_{2}} + \\frac{SMD^2}{2(N_{1} + N_{2})}",
             # see my commenst
             "\\frac{1}{N - 3}")
             #"\\frac{s_{i}^2}{n_{i}}",
             #"")

# Maybe add some examples for each effect size in a new column. SHould help
eg <- c("CTmin, CTmax, LC50, LT50, Metabolic Rate (MR)",
        "Variability in CTmin, CTmax, Metabolic Rate (MR)",
        "Ratio between pollutant exposed treatment (e.g., BPA-exposed group) and control (no pollutant)",
        "Difference in immune response between males and females, performance difference in the presence of stressor compared to absence of stressor",
        "Relationship between sex hormones and immune responses or metabolic rate and behaviour")

table_fin <- data.frame(names, eqns_yi, eqns_vi, eg)

footnotes <- c("Notes: J = 1 - \\frac{3}{4\\left(N_{1} + N_{2} - 2\\right) - 1}",
               "SD_{p} = \\sqrt \\frac{\\left( N_{1}-1 \\right)SD_{1}^2 + \\left( N_{2}-1 \\right)SD_{2}^2}{N_{1} + N_{2} - 2}")

# Note: It is esssential that you be clear that the function 'compose' is exported from the flextable package. That's because purr also has the same function, so it gets messy.
tablea <- flextable(table_fin)                                                                                %>% 
          flextable::compose(j = 1:4, part = "header", value = as_paragraph(as_b(c("Effect Measure", "Definition", "Sampling Variance", "Examples")))) %>% 
          flextable::compose(j = 2:3, value = as_paragraph(as_equation(c( eqns_yi, eqns_vi))))             %>%
          flextable::compose(j = 4, value = as_paragraph(eg))             %>%
          flextable::width(j = 1, 3)                                                                          %>% 
          flextable::width(j = 2, 2) %>% 
          flextable::width(j = 4, 5) %>% 
          flextable::footnote(i = 4, j = 1, value = as_paragraph(as_equation(footnotes)),
               ref_symbols = c("a"),
               part = "body", inline = TRUE) %>% 
          flextable::font(part = "all", fontname = "Times New Roman")
          

FitFlextableToPage(tablea, pgwidth = 8)

```

#### *Expanding the Scope of Effect Size Metrics in Comparative Physiology*

As can be seen in Table \@ref(tab:tablea), none of the effect measures control for nuisance heterogeneity -- a point reinforced by our survey. For example, the magnitude of *lnRR* or *SMD* can depend on differences in the temperatures, dosages, or pH applied to each treatment. The same applies to modelling the means. For example, standard metabolic rate (SMR) is temperature-dependent. As such, one needs to standardise the temperature measurement to compare across studies [@White2006; @Uyeda2017] (if, of course, temperature is not of interest itself). While we could model nuisance heterogeneity explicitly, this may not always be desirable. It can often be useful to standardise the effect to both ease its interpretation and simplify modelling. In Box 1, we provide readers with guidance on how comparative physiologists can apply corrections to the effect measure itself. We highlight two examples in Box 1 that can be easily generalized to alternative effect size measures and show how they are distinct from traditional effect measures (Figure \@ref(fig:fig0)). Below we focus in on one familiar example to elaborate on how a traditional effect size, such as $lnRR$, can be reformalised to capture nuisance variation. We use a common, well understood, effect measure of interest to comparative physiologists -- the temperature coefficient ($Q_{10}$). 

```{r, fig0, fig.cap="**Effect sizes from old to new**. ‘Traditional’ effect sizes (top left) are somehow detached from more biologically relevant measures commonly used in ‘Comparative physiology’ (top right) although statistical connections have always existed (‘Universal’; top middle). By combining traditional effects with physiological parameters, and correcting the resulting quantities for nuisance variation, we can derive a new generation of biologically relevant, easily interpretable effect measures for use in meta-analyses (‘Expanded’; bottom). For abbreviations of common effect sizes see Table 1. lnRRQ10 = Q10 response ratio; lnCVRQ10 = log Q10 coefficient of variation ratio; SMDT = Temperature corrected standardised mean difference; ARR = acclimation response ratio."}
image <- image_read(here::here("figs", "Fig0_v1_ML.png"))
image
```

#### *Comparing Changes in Mean Physiological Rates,* $Q_{10}$

A common experiment in comparative physiology is to manipulate the temperature organisms experience and measure some physiological rate (e.g., metabolic rate). Using the effect size measures from Table \@ref(tab:tablea) would result in the effect sizes varying with the temperatures applied within and across studies contributing to 'comparability' issues. For example, an effect size for a temperature manipulation of 10°C would be larger than an effect size for a temperature manipulation of 5°C (see Figure \@ref(fig:fig1)). As such, it is common to standardize effects by temperature. One common effect size measure already used in comparative physiology to compare physiological rates is the temperature coefficient $Q_{10}$ [e.g., @Rodgers2021; @Seebacher2015; @Havird2020]. This effect size describes the multiplicative change in physiological rates across a 10°C temperature change. Higher $Q_{10}$ values indicate larger changes in physiological rates. However, currently there is no formal sampling variance associated with $Q_{10}$, making it challenging to make use of the full power of weighted meta-analytic models. Interestingly, $Q_{10}$ can be seen as a variant of *lnRR*, meaning that we can derive a $Q_{10}$-based effect size and sampling error using the well-known mathematical properties of *lnRR*. This opens up the meta-analytic toolbox and improves our ability to account for well known sources of non-independence [@Lajeunesse2011; @Noble2017].

Prior to showing how the relevant $Q_{10}$ effect size can be calculated it is useful to understand its similarities to *lnRR*. The *lnRR* described by @Hedges1999 and extended by @Lajeunesse2015 can be calculated as follows [but see also @Senior2020]:

$$
\begin{equation} 
  \begin{aligned}
  \ln{RR} = \ln\left ( \frac{M_{1}}{M_{2}}\right )
  \end{aligned}
  (\#eq:lnRR)
\end{equation} 
$$

$$
\begin{equation} 
  s^2_{lnRR} = \left ( \frac{SD_{1}^2}{N_{1}M_{1}^2}\right ) + \left ( \frac{SD_{2}^2}{N_{2}M_{2}^2}\right )
  (\#eq:slnRR)
\end{equation} 
$$

In equation \@ref(eq:lnRR), $M_{1}$ is the mean of group 1 (e.g., a control group), whereas $M_{2}$ is the mean of group 2 (e.g., a treatment group). The mean, $M_{i}$, for group *i* can be any measurement type (e.g. a physiological rate, mass etc) so long as the variable is measured on the ratio scale. Natural log transformation of this ratio makes the effect size normally distributed (as commonly assumed by meta-analytic models). Equation \@ref(eq:slnRR) is the analytical solution for *lnRR*'s sampling variance where $SD_{1}^2$ and $SD_{2}^2$ is the sample standard deviation and $N_{1}$ and $N_{2}$ is the sample size for group 1 and 2, respectively.

The equations for *lnRR* and its sampling variance allow us to extend this to $Q_{10}$ based effect sizes. Recall that $Q_{10}$ is described as follows:

$$
\begin{equation} 
  Q_{10} = \left( \frac{R_{2}}{R_{1}} \right)^{ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }
  (\#eq:q10)
\end{equation} 
$$ 

Here, $R_{1}$ and $R_{2}$ are mean physiological rates and $T_{1}$ and $T_{2}$ are the temperatures that these rates are measured. Natural log transformation of equation \@ref(eq:q10) leads to the following log transformed $Q_{10}$:

$$
\begin{equation} 
  lnRR_{Q_{10}} = ln\left( \frac{R_{2}}{R_{1}} \right){ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }
(\#eq:lnq10)
\end{equation} 
$$ 

Equation \@ref(eq:lnq10) is essentially a temperature-corrected equivalent of *lnRR* when the numerator and denominator are measured at different temperatures. This allows one to compare the mean of two temperature treatments directly regardless of the temperatures at which these groups have been measured. Here, we will refer to this as the log $Q_{10}$ response ratio, $lnRR_{Q_{10}}$. Notably, using this effect rather than the traditional $Q_{10}$ has two statistical advantages: 1) zero becomes biologically meaningful as zero means two rates are exactly the same and 'significantly different from zero' means that two rates are significantly different to each other and 2) $lnRR_{Q_{10}}$ is more likely to satisfy the assumption of residual normality than $Q_{10}$ [see @Hedges1999]. The recognition of this equivalence means that we can calculate the sampling variance for equation \@ref(eq:lnq10) as follows:

$$
\begin{equation} 
  s^2_{lnRR_{Q_{10}}} = \left( \frac{SD_{2}^2}{R^2_{2}N_{2}} + \frac{SD_{1}^2}{R^2_{1}N_{1}} \right){ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }^2
  (\#eq:Vlnq10)
\end{equation} 
$$

#### *Formalising Effect Size Metrics that Compare Changes in Variability Across Treatments in the Presence of Nuisance Heterogeneity*

@Nakagawa2015 recently proposed analogous effect size estimates to *lnRR* that allow for comparisons of changes in variance between two groups, the log variance ratio (*lnVR*) and the log coefficient of variation (*lnCVR*). Like *lnRR*, *lnVR* and *lnCVR* are ratios that describe the relative difference in trait variability between two groups. We refer readers to @Nakagawa2015 for the equations describing *lnVR* and *lnCVR*, but these can easily be extended to their $Q_{10}$ analogues (and associated sampling variances) as follows:

$$
\begin{equation} 
lnVR_{Q_{10}} = ln\left( \frac{SD_{2}}{SD_{1}} \right){ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }
(\#eq:lnq10VR)
\end{equation} 
$$ $$
\begin{equation} 
s^2_{lnVR_{Q_{10}}} = \left( \frac{1}{2\left( N_{2}-1 \right)} + \frac{1}{2\left(N_{1} - 1\right)} \right){ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }^2
(\#eq:slnq10VR)
\end{equation} 
$$

Equations \@ref(eq:lnq10VR) and \@ref(eq:slnq10VR) describe the change in physiological rate variance [equation \@ref(eq:lnq10VR)] relative to a 10°C temperature change, along with its sampling variance [equation \@ref(eq:slnq10VR)]. While this is a useful metric, as discussed by @Nakagawa2015, there is often a strong mean-variance relationship that needs to be accounted for in analysing changes in variance. As such, we can calculate the coefficient of variation, which standardises changes in variance for changes in means as follows:

$$
\begin{equation} 
lnCVR_{Q_{10}} = ln\left( \frac{\text{CV}_{2}}{\text{CV}_{1}} \right){ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }
(\#eq:lnq10CVR)
\end{equation} 
$$ $$
\begin{equation} 
s^2_{lnCVR_{Q_{10}}} = \left[ \frac{(\text{SD}_{1})^2}{N_{1}({R}_{1})^2} + \frac{(\text{SD}_{2})^2}{N_{2} ({R}_{2})^2} + \frac{1}{2\left( N_{1}-1 \right)} + \frac{1}{2\left(N_{2} - 1\right)} \right]{ \left(\ \frac{10^{\circ}C}{T_{2}-T_{1}} \right) }^2
(\#eq:slnq10CVR)
\end{equation} 
$$

where $CV$ is the coefficient of variation defined as $SD / R$. Whether one choose to use SD or CV-based effect size depends on questions at hand [see @Nakagawa2015; @Senior2020].

Our example using $Q_{10}$, a well-known effect measure in comparative physiology, shows that common effect size's can be re-formalised to account for nuisance heterogeneity (in this case temperature). In doing so, we are making assumptions about the nature of temperature effects on an effect size. Nonetheless, we can apply similar approaches to other commonly used effect size metrics. We describe more generally how this can be done in Box 1, applying similar principles to standardise temperature differences for slopes and standardised mean differences.

## **Meta-Analytic Models to Control for Nuisance Heterogeneity and Investigate Heterogeneous Effects Within and Across Studies**

It will not always be possible to derive an effect size that completely controls for nuisance heterogeneity at the effect size level. This limitation is partly because treatment effects may not be simple linear or exponential functions of the mean response, making the effect sizes we discuss above unsuitable [e.g., thermal performance curves; @Noble2018]. For example, dosages applied to treatments can follow quite complex non-linear relationships in relation to some mean response (e.g., quadratic relationships). When this occurs, we recommend comparative physiologists apply meta-regression approaches, controlling for nuisance heterogeneity as a moderator. In many cases, this will be the easiest, or even preferred, approach because exploring drivers of heterogeneity is of prime interest in most meta-analyses anyway. Nonetheless, there are some simple statistical approaches a comparative physiologist can use to make the overall effects more easily interpretable, allowing one to control for nuisance heterogeneity, while also testing other biological moderators of interest [@Schielzeth2010]. Before diving into meta-regression models, we will first overview the meta-analytic models commonly used.

#### *Multilevel Meta-Analysis when the Overall Effect is of Interest*

A common goal of meta-analysis is to obtain an overall meta-analytic mean effect size estimate and some form of uncertainty around that mean, like a 95% confidence interval (CI). Including a prediction interval (PI) can also be useful (discussed below) [@Nakagawa2021c]. Estimating an overall mean and 95% CI is generally done with a simple random-effects or multilevel meta-analytic model that accounts for effect size sampling error [@Nakagawa2017; @NakagawaSantos2012]. More often than not, meta-analyses in comparative physiology will have complex hierarchical structure. For example, multiple effect sizes may be taken from a single study on traits measured on the same individuals or from many different species that share an evolutionary history [@Cinar2021; @Noble2017]. As such, it is far more likely that comparative physiologists will need to apply a multilevel meta-analytic model to control for the various sources of non-independence [@Cinar2021; @NakagawaSantos2012; @Song2021; @Nakagawa2021; @Noble2017]. Multilevel models are also extremely useful in describing the various drivers of effect size variance (a feature we describe below). For the purpose of our discussion, we will assume one needs to use more advanced multilevel models. Having said that, in some instances, it may be sufficient for a meta-analysis to make use of traditional random effects models. We refer readers to excellent reviews and books that overview the distinctions between common (fixed) effect, random-effect and multilevel models and when one might want (or not want) to apply these models [@Nakagawa2017; @NakagawaSantos2012; @Koricheva2013; @Borenstein2009; @Schmid2021].

Assume that we are interested in understanding the overall effect of, say, testosterone (T) on offspring traits [e.g., see @Podmola2018]. We might extract data from studies manipulating T in bird eggs. Of course, these studies are diverse, spanning many species and applying different dosages of T. If the studies are experimental in nature, then a standardised effect size, such as $lnRR$ or *SMD*, might be applicable. We then might fit an overall multilevel meta-analytic model as follows: 
$$
\begin{equation} 
\begin{split}
Y_{i} = \beta_{0} + a_{k[i]} + sp_{k[i]} + s_{j[i]} + e_{i} + m_{i} \\
a_{k[i]}\sim N(0, \sigma^{2}_{phylogeny}\textbf{A}), \\
sp_{k[i]}\sim N(0, \sigma^{2}_{species}\textbf{I}), \\
s_{j[i]}\sim N(0, \sigma^{2}_{study}\textbf{I}), \\
e_{i}\sim N(0, \sigma^{2}_{residual}\textbf{I}), \\
m_{i} \sim N(0, v_{i}\textbf{I}) \\
\end{split}
(\#eq:MLM)
\end{equation} 
$$

where $Y_{i}$ is the *i*th effect size (*i* = 1 ... $N_{ES}$, the number of effect sizes), $\beta_{0}$ is the overall meta-analytic mean, $a_{k[i]}$ is the phylogenetic effect (a random effect) for species *k* applied to effect size *i* [i.e., species effects because of shared evolutionary history, @Cinar2021]. Phylogenetic effects are assumed to be normally distributed deviates sampled from a distribution with a mean of 0 and variance $\sigma^{2}_{phylogeny}$ [i.e., *N*$(0, \sigma^{2}_{phylogeny}\textbf{A})$], where $\textbf{A}$ is a phylogenetic correlation matrix derived from a phylogenetic tree. $sp_{k[i]}$ is an additional species-specific effect for the *k*th species applied to effect size *i* [i.e., these are species-specific effects because of shared ecology and other factors, @Cinar2021], $s_{j[i]}$ is the study-specific effect for the *j*th study applied to effect size *i*, $e_{i}$ is the effect size-specific effect (or within study effect, or residuals) for the *i*th effect size, and $m_{i}$ is the sampling variance effect around the *i*th effect as a result of variation in precision among each effect size, $v_{i}$ (which is known as the sampling variance for the effect). 

This model is a 'weighted' multilevel meta-analysis model because the estimation of the overall meta-analytic mean, $\beta_{0}$, is partially weighted by the inverse sampling variance of each effect size. Weighted meta-analytic models are important to use because they: 1) improve the precision on meta-analytic mean estimates by accounting for sampling variance; 2) allow for a formal analysis of heterogeneity; 3) and give precedence to higher quality studies (see below). From our survey, `r with(weighted, weighted[meta_analysis_weighted == "weighted model","percent"])*100`% of studies used a weighted meta-analytic model; however, of the studies self described as 'meta-analyses', `r with(weighted_meta, weighted_meta[meta_analysis_weighted == "unweighted model","percent"])*100`% (N = `r with(weighted_meta, weighted_meta[meta_analysis_weighted == "unweighted model","n"])` of `r with(weighted_meta, sum(weighted_meta[,"n"]))`) did not account for sampling variance. Many studies used 'Linear Regression' (including linear and generalised linear mixed effects models) as the main type of model fit to the data (Figure \@ref(fig:figsurv)C). Of the studies using weighted meta-analytic models `r with(het_reported, sum(het_reported[1:2,"percent"])*100)`% (N = `r with(het_reported, sum(het_reported[1:2,"n"]))` meta-analyses) did not report any measure of heterogeneity, which is unfortunate given how important these measures are to interpreting effects.
 
Importantly, if we have effect sizes that are derived from the *same* sample of organisms (e.g., because traits are measured on the same sets of individuals), then we need to remove this dependency from the calculation of each $v_{i}$; we can then account for the assumed sampling covariance between effect sizes by modifying $\textbf{I}$ to include off-diagonals that describe this covariance [See Box 1 and @Noble2017]. Alternatively, robust variance estimators can also be used to deal with effect size non-independence [@Song2021; @Nakagawa2021]. The fact that we can obtain an overall estimate of sampling variance (i.e., $\sigma^2_{m}$, see below for how it is defined) is very important because it provides a way for us to understand just how much variation in effects are the result of sampling differences across studies versus other, potentially important sources of variation, such as differences in the methods applied, species differences, or even real biological effects that impact the effect size a study is likely to observe [@Nakagawa2017; @NakagawaSantos2012]. This is formalised in what we call 'heterogeneity analysis' which we describe below. 

Importantly, this model provides us with the answer to our question: across all the species and studies manipulating egg T, how much of an overall effect does T have on offspring traits relative to control conditions? Of course, the overall effect does not provide us with a way to interpret its magnitude in the context of how much testosterone (T) has been applied in the treatments used in the sample of studies. The most we can say about it is that the effect is small, moderate or large given the sample of effect sizes extracted from this set of studies. In the next section, we show how to 'correct' the overall effect size so that its interpretation is more meaningful.

#### *Multilevel Meta-regression to Understand Variation, Account for Nuisance Heterogeneity and Improve Effect Interpretation*

Heterogeneity among effects that result from nuisance heterogeneity can be dealt with using multilevel meta-regression models. Multilevel meta-regression models include all the same random effects that we have already discussed, but they also include fixed effects (i.e., predictors or moderators) that attempt to explain changes in the mean effect size. In other words, we can modify our multilevel meta-analytic model and turn it into a multilevel meta-regression model as follows:

$$ 
\begin{equation} 
Y_{i} = \beta_{0} + \sum \beta_{j}x_{j} + a_{k[i]} + sp_{k[i]} + s_{j[i]} + e_{i} + m_{i} \
(\#eq:MLMR)
\end{equation} 
$$

where $\sum \beta_{j}x_{j}$ is simply the sum of all effects for all moderators (fixed effects), $x_{j}$. All other notation is the same as described above. Importantly, the variable $x_{j}$ could be any moderator collected from studies, including dosage, temperature, salinity, or pH. Some moderators will be at the level of the study (e.g., was the study experimental or observational in nature) but others could be taken at the effect size level (i.e., was the effect derived using a temperature of 23°C or 35°C). By including these moderators in a meta-regression model, the interpretation of the overall meta-analytic mean, $\beta_{0}$, changes. For example, assume we collected the change in *in ovo* testosterone dosage relative to a control group (i.e., in ng T / g yolk) for our meta-analysis on egg T effects on bird offspring traits. If the untransformed dosage, $x_{j}$, is included in the model then the overall meta-analytic mean estimate, $\beta_{0}$, would be the mean effect of T on traits when the dosage difference between the treatment and control group is 0 ng T / g yolk (i.e., it would be reflective of unmanipulated eggs). Of course, this interpretation does not make much sense.

We can, however, apply some simple transformations to make the overall mean estimate more intuitive while also improving the interpretation of non-linear parameters and interactions estimated from the model [@Schielzeth2010; @GelmanHill2007]. One simple transformation would be to centre the variable $x_{j}$ by subtracting each value from the mean to create a new input variable (i.e., $c_{j}=x_{j}-\bar{x}$, where the subscript *j* denotes each individual effect size dosage difference). The new variable, $c_{j}$, is now centered on the mean and can replace $x_{j}$ in the meta-regression model. When the model is refit with $c_{j}$, the estimated $\beta_{0}$ can now be more intuitively interpreted as the overall mean effect of T on offspring traits at an average dosage difference between treatment and control groups. Importantly, by centering, we retain the original units (ng T / g yolk) of the variable, which can be very useful to ease the interpretation of the effect magnitude (e.g., when the dosage difference is 10 ng T / g yolk). 

Given it is very common to estimate and compare overall meta-analytic means (i.e., $\beta_{0}$) in meta-analyses, this centering can be particularly useful in making these means more interpretable. Mean centering can even be extended to include other 'nuisance' variables that might creep into the dataset; the same centering can be done with a second variable, and the overall mean adjusted and interpreted in the context of this new variable along with dosage. Of course, if one is not interested in the magnitude of the effect, we can simply model mean reproductive output as a function of dosage (often what are referred to as 'arm-based' meta-analytic models). Here, one can model the mean for each group (i.e., control and treatment) and account for the known sampling variance associated with each group mean. Dosage, or other continuous variables, like temperature, can then be modeled (accounting for sampling variance) to understand how mean reproductive output varies. It is important to recognise that all means need to be comparable and that these models are more complex to fit. While they can be equivalent to 'contrast-based' models, they require complex interactions to be estimated [@Nakagawa2015].

Centering moderator variables, like temperature and dosage, not only provides a way to make the overall mean effect more interpretable in the face of treatment heterogeneity, but it also allows more complex relationships to be fit without compromising interpretations, such as when one includes non-linear parameters (e.g., higher-order polynomials) and interactions with other variables. In other words, linear / main effects can still be interpreted normally in the presence of non-linear / interactions fit in the model [@Schielzeth2010; @GelmanHill2007]. We provide examples in the online Supplementary Material (with R code) to show readers how the models we describe above can be fit, and how meta-analytic means can be adjusted for treatment heterogeneity.

#### *Heterogeneity Analysis: How Much Nuisance Heterogeneity Actually Exists?*

As we have already emphasised, quantifying effect size heterogeneity provides the impetus for exploring why effects might vary within and across studies, while also providing context for interpreting the generality of overall effects. There are a number of measures commonly used to quantify effect size heterogeneity [@Borenstein2019]; however, in ecological and evolutionary meta-analysis, heterogeneity is often calculated and reported as $I_{total}^2$ as follows (if using a multilevel meta-analytic model as we describe above):

$$ 
\begin{equation} 
I^2_{total} = \frac{\sigma^2_{study} + \sigma^2_{phylogeny} + \sigma^2_{species} + \sigma^2_{residual}}{\sigma^2_{study} + \sigma^2_{phylogeny} + \sigma^2_{species} + \sigma^2_{residual} +\sigma^2_{m}} \
(\#eq:itot)
\end{equation} 
$$

where $\sigma^2_{total} = \sigma^2_{study} + \sigma^2_{phylogeny} + \sigma^2_{species} + \sigma^2_{residual} +\sigma^2_{m}$ is the total effect size variance and $\sigma^2_{m}$ is the 'typical' sampling error variance calculated as:

$$
\begin{equation} 
\sigma_{m}^2 = \sum w_{i}\left( k-1\right) / \left[ \left( \sum w_{i}\right)^2  + \sum w_{i}^2\right] \
(\#eq:w)
\end{equation} 
$$

where *k* is the number of studies and the weights, $w_{i} = \frac{1}{v_{i}}$, can be calculated using the inverse of the sampling variance ($v_{i}$) for each effect size, *i*.

Quantifying heterogeneity using $I_{total}^2$ provides a formal way to assess the relative amount of variation that is the result of 'true' biological or methodological differences as opposed to chance (i.e., sampling variance) [@NakagawaSantos2012; @Higgins2002]. In other words, $I_{total}^2$ is the percentage of variance between effect sizes after removing the effects of sampling error [@Higgins2002]. Note that we can only calculate this metric if we have an estimate of the sampling variance for a given effect measure because only then can we quantify the proportion of variation that is the result of sampling variability. @Senior2016 have shown that total heterogeneity is often extremely high in ecological and evolutionary meta-analysis (\~91%), suggesting that effect measures vary widely within and across studies. Some of the variation is clearly the result of working with different species, strains, or measuring different traits and outcome measures. However, some of this variation also arises because of methodological differences across studies (e.g., different temperature or dosage treatments).

Formally quantifying and presenting heterogeneity estimates from meta-analytic models can provide a way to understand the major drivers of effect size variation by producing various $I^2$ estimates that can be compared within and across studies. For example, we could fit the multilevel model described above to understand what proportion of variation is the result of, say, 'study' effects following @NakagawaSantos2012: $I^2_{study} = \frac{\sigma^2_{study}}{\sigma^2_{total}}$ where $\sigma^2_{study}$ is the study-specific variance.

Some readers may notice the similarities between $I^2$ and $R^2$ [@Nakgawa2013; @Nakagawa2010; @Nakagawa2017]. If we want to formally assess how much effect size variation is the result of nuisance heterogeneity (e.g.,  temperature and dosage differences applied across studies) then we could fit our multilevel meta-regression model including dosage or temperature (linear, quadratic or even more complex fits), and estimate how much variation is explained by these fixed effects following @Nakgawa2013.

$$
\begin{equation} 
R^2_{marginal} = \frac{\sigma^2_{fixed}}{\sigma^2_{fixed} + \sigma^2_{study} + \sigma^2_{phylogeny} + \sigma^2_{species} + \sigma^2_{residual}} \
(\#eq:r2)
\end{equation} 
$$

Note that this formula does not include $\sigma^2_{m}$ as sampling error variance is assumed to be known in meta-analysis, as explained above. When including continuous moderators, such as dosage, temperature, salinity, and even pH, $R^2_{marginal}$ provides a formal means to assess just how much variation in effects is the result of nuisance heterogeneity. Other biological moderators of interest could also be included as fixed effects and $R^2_{marginal}$ can be calculated for each independently, or all together. Importantly, moderators could be those that explain variation at the effect size level (i.e., dosage, temperature) or variation at the study or species level (e.g., reproductive mode, endothermy, etc.). $R^2_{marginal}$, or how we like to think of it in this context as $R^2_{nuisance}$, may be a useful measure to help readers understand just how much effect variation can result from the specific treatment application. If the heterogeneity is high as a result of, say, dosage differences, then it is clear that the choice of dosage will have a critical impact on the effect of interest. Comparative physiologists interested in implementing these calculations can do so using our packages `orchaRd` [@Nakagawa2021c] or `metaAidR` (<https://github.com/daniel1noble/metaAidR>).

Heterogeneity described using $I^2$ measures can be useful for understanding the relative contributions of different factors to effect size variation; however, prediction intervals might be more appropriate in many cases [@Nakagawa2021c; @Borenstein2019]. Prediction intervals describe the range of plausible effect size values expected from a future study [@Nakagawa2021c]. This is different from a confidence interval that expresses the range of uncertainty around a statistical parameter estimate. Unlike $I^2$, prediction intervals (PI's) are probably more meaningful in the context of meta-analysis because they explicitly incorporate measures of dispersion around a mean effect size. They provide information about the likely effect size one can expect if we were to randomly sample a new population. For example, assume that we were interested in the overall impact of salinity stress in freshwater fish. To tackle this question, we collected experimental studies measuring fish swimming performance under high salinity treatments (\~15--20ppm Na Cl) compared to freshwater (\~0ppm Na Cl) controls, using *SMD* to quantify the effect salinity had on swim performance. We conduct a meta-analysis and estimate an overall *SMD* of 0.50 with a 95% prediction interval of 0.05 to 0.85. The PI indicates that effects can vary widely from as low as an *SMD* of 0.05 to as high as an *SMD* 0.85, depending on the population. In addition, if we were to repeat a similar study, we would expect a new effect to fall within the range of 0.05 and 0.85, 95% of the time [@Borenstein2019; @Nakagawa2021c]. This is a very intuitive interpretation of how variable effects are, yet PIs are often not reported in meta-analyses [@Nakagawa2021c], and we encourage more meta-analysts to report these (for examples of PIs, see Supplementary Materials).

## **Conclusions**

Comparative physiologists are interested in meta-analysing effects across a diversity of species, experimental designs, and environments. Importantly, sampling variances for many effect sizes commonly used by comparative physiologists (e.g., CTmax, $Q_{10}$ etc) can be formalized and powerful meta-analytic models can be easily applied to these effect measures (Figure \@ref(fig:fig0)). While an overall meta-analytic mean may be of interest, more often than not, understanding the drivers of effect size heterogeneity will be the primary interest. However, factors such as temperature and dosage differences across studies may generate obvious sources of heterogeneity that may not be of prime interest. Instead, comparative physiologists might simply want to focus on biological drivers of effect size variability and want an effect size or analytic approach that allows them to remove these ‘nuisances’. Surveying the comparative physiology literature shows that nuisance heterogenity is common, and is often not completely dealt with in a meta-analysis. Here, we provide a set of tools to deal with nuisance heterogeneity (Figure \@ref(fig:fig1)) by reinventing standard effect sizes and/or using mean centered nuisance variables in meta-regression models. Estimating complex meta-regression models with a multitude of fixed effects might result, however, in more challenging model interpretation. As such, a combined approach might be more desirable. Nuisance heterogeneity can be dealt with by using an appropriate effect size and associated sampling variance in combination with meta-regression models that contain moderators that test biological hypotheses of interest. Indeed, this may even be a necessity to simplify the model. The set of tools we describe provide clarification around the importance and limitations of heterogeneity. We also hope to provide new ways to help comparative physiologists communicate effect measures more richly to guide our understanding and decisions around pressing global challenges.

## **Acknowledgements**

We would like to thank the Editorial board (Craig Franklin, Michaela Handel and Charlotte Rutledge) for inviting us to contribute to this special issue along with feedback on previous drafts. We would also like to thank Megan Head and two anonymous reviewers for very helpful comments on previous drafts. DWAN, SMD, SN, ML and REO were supported by ARC Discovery Projects (DP210101152 to DWAN, DE180100202 to SMD, and DP200100367 to SN, ML and DWAN). PP and SB were supported by a UNSW Scientia PhD Scholarship.

## **Author Contributions**
DWAN, SN: Project Administration, Conceptualization, Writing - original draft, Visualization, Funding acquisition, Resources, Formal Analysis, Methodology, Software; ML, PP, REO, SD, SB: Writing – review & editing, Visualization, Validation, Software, Data Curation, Formal analysis.


## **References**
